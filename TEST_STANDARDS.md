# å¾·å·æ‰‘å…‹é¡¹ç›®æµ‹è¯•ç¼–å†™è§„èŒƒ

> åŸºäºé¡¹ç›®æµ‹è¯•æ¶æ„é‡æ„åçš„ç»Ÿä¸€æµ‹è¯•ç¼–å†™æ ‡å‡†

---

## ğŸ“‹ ç›®å½•

- [1. æ ¸å¿ƒåŸåˆ™](#1-æ ¸å¿ƒåŸåˆ™)
- [2. ç›®å½•ç»“æ„è§„èŒƒ](#2-ç›®å½•ç»“æ„è§„èŒƒ)
- [3. å‘½åè§„èŒƒ](#3-å‘½åè§„èŒƒ)
- [4. æµ‹è¯•åˆ†ç±»å’Œè¦æ±‚](#4-æµ‹è¯•åˆ†ç±»å’Œè¦æ±‚)
- [5. ç¼–å†™è§„èŒƒ](#5-ç¼–å†™è§„èŒƒ)
- [6. è´¨é‡æ ‡å‡†](#6-è´¨é‡æ ‡å‡†)
- [7. å·¥å…·å’Œé…ç½®](#7-å·¥å…·å’Œé…ç½®)
- [8. ç»´æŠ¤æŒ‡å—](#8-ç»´æŠ¤æŒ‡å—)
- [9. å¿«é€Ÿå‚è€ƒ](#9-å¿«é€Ÿå‚è€ƒ)

---

## 1. æ ¸å¿ƒåŸåˆ™

### 1.1 æµ‹è¯•å“²å­¦
- **å¯è¯»æ€§ä¼˜å…ˆ**: æµ‹è¯•å³æ–‡æ¡£ï¼Œåº”è¯¥æ¸…æ™°è¡¨è¾¾æ„å›¾
- **ç‹¬ç«‹æ€§**: æ¯ä¸ªæµ‹è¯•ç‹¬ç«‹è¿è¡Œï¼Œä¸ä¾èµ–å…¶ä»–æµ‹è¯•
- **å¿«é€Ÿåé¦ˆ**: å•å…ƒæµ‹è¯•åº”è¯¥å¿«é€Ÿæ‰§è¡Œï¼Œæä¾›å³æ—¶åé¦ˆ
- **è¦†ç›–å…³é”®è·¯å¾„**: é‡ç‚¹æµ‹è¯•æ ¸å¿ƒé€»è¾‘å’Œè¾¹ç•Œæƒ…å†µ

### 1.2 ä¸‰å±‚æµ‹è¯•ç­–ç•¥
```
ğŸ”º E2E Tests (å°‘é‡)        # å…³é”®ç”¨æˆ·æµç¨‹
ğŸ”² Integration Tests (é€‚é‡) # æ¨¡å—é—´äº¤äº’
ğŸ”³ Unit Tests (å¤§é‡)       # å•ä¸ªå‡½æ•°/ç»„ä»¶
```

---

## 2. ç›®å½•ç»“æ„è§„èŒƒ

### 2.1 ç»Ÿä¸€çš„æµ‹è¯•ç›®å½•ç»“æ„

```
é¡¹ç›®æ ¹ç›®å½•/
â”œâ”€â”€ backend/__tests__/
â”‚   â”œâ”€â”€ unit/           # å•å…ƒæµ‹è¯•
â”‚   â”œâ”€â”€ integration/    # é›†æˆæµ‹è¯•
â”‚   â”œâ”€â”€ flow/          # æµç¨‹æµ‹è¯•
â”‚   â”œâ”€â”€ fixtures/      # æµ‹è¯•æ•°æ®
â”‚   â”œâ”€â”€ helpers/       # æµ‹è¯•å·¥å…·
â”‚   â””â”€â”€ setup.ts       # å…¨å±€é…ç½®
â”‚
â”œâ”€â”€ frontend/__tests__/
â”‚   â”œâ”€â”€ components/    # ç»„ä»¶æµ‹è¯•
â”‚   â”œâ”€â”€ pages/         # é¡µé¢æµ‹è¯•
â”‚   â”œâ”€â”€ hooks/         # Hookæµ‹è¯•
â”‚   â”œâ”€â”€ services/      # æœåŠ¡æµ‹è¯•
â”‚   â”œâ”€â”€ integration/   # é›†æˆæµ‹è¯•
â”‚   â”œâ”€â”€ fixtures/      # æµ‹è¯•æ•°æ®
â”‚   â”œâ”€â”€ helpers/       # æµ‹è¯•å·¥å…·
â”‚   â””â”€â”€ setup.ts       # æµ‹è¯•é…ç½®
â”‚
â””â”€â”€ e2e-tests/         # ç«¯åˆ°ç«¯æµ‹è¯•
    â”œâ”€â”€ tests/
    â”œâ”€â”€ fixtures/
    â””â”€â”€ playwright.config.ts
```

### 2.2 æ–‡ä»¶ç»„ç»‡åŸåˆ™
- **æŒ‰åŠŸèƒ½åˆ†ç»„**: ç›¸å…³æµ‹è¯•æ”¾åœ¨åŒä¸€ç›®å½•
- **é•œåƒæºç ç»“æ„**: æµ‹è¯•ç›®å½•ç»“æ„åº”åæ˜ æºç ç»„ç»‡
- **å…±äº«èµ„æºé›†ä¸­**: fixtureså’Œhelpersç»Ÿä¸€ç®¡ç†

---

## 3. å‘½åè§„èŒƒ

### 3.1 æ–‡ä»¶å‘½å
| ç±»å‹ | æ ¼å¼ | ç¤ºä¾‹ |
|-----|------|------|
| **å•å…ƒæµ‹è¯•** | `*.test.ts` | `GameState.test.ts` |
| **ç»„ä»¶æµ‹è¯•** | `*.test.tsx` | `GameTable.test.tsx` |
| **E2Eæµ‹è¯•** | `*.spec.ts` | `auth.spec.ts` |
| **æµ‹è¯•å·¥å…·** | `*.ts` | `testUtils.ts` |
| **æµ‹è¯•æ•°æ®** | `*.ts` | `gameData.ts` |

### 3.2 æµ‹è¯•å¥—ä»¶å‘½å
```typescript
// âœ… å¥½çš„å‘½å
describe('GameState', () => {})
describe('GameState - Player Management', () => {})
describe('PlayerSeat Component', () => {})

// âŒ é¿å…çš„å‘½å  
describe('Test GameState', () => {})
describe('gameState tests', () => {})
```

### 3.3 æµ‹è¯•ç”¨ä¾‹å‘½å
```typescript
// âœ… æè¿°æœŸæœ›è¡Œä¸º
test('should add player when room has space', () => {})
test('should throw error when room is full', () => {})
test('renders loading state correctly', () => {})

// âŒ ä¸å¤Ÿå…·ä½“
test('adds player', () => {})
test('test error', () => {})
```

---

## 4. æµ‹è¯•åˆ†ç±»å’Œè¦æ±‚

### 4.1 å•å…ƒæµ‹è¯•
**èŒƒå›´**: å•ä¸ªå‡½æ•°ã€ç±»ã€ç»„ä»¶  
**ç‰¹ç‚¹**: å¿«é€Ÿã€éš”ç¦»ã€ä¸“æ³¨  
**å·¥å…·**: Jest (åç«¯), Vitest (å‰ç«¯)

**é‡ç‚¹æµ‹è¯•**:
- æ¸¸æˆé€»è¾‘ç®—æ³•
- å·¥å…·å‡½æ•°
- ç»„ä»¶æ¸²æŸ“å’Œäº¤äº’
- è¾¹ç•Œæ¡ä»¶å’Œé”™è¯¯å¤„ç†

### 4.2 é›†æˆæµ‹è¯•
**èŒƒå›´**: æ¨¡å—é—´äº¤äº’  
**ç‰¹ç‚¹**: çœŸå®ç¯å¢ƒã€æ•°æ®æµ  
**å·¥å…·**: Jest + æµ‹è¯•æ•°æ®åº“, React Testing Library

**é‡ç‚¹æµ‹è¯•**:
- APIè·¯ç”±å®Œæ•´æµç¨‹
- Socketé€šä¿¡
- æ•°æ®åº“æ“ä½œ
- å‰ç«¯é¡µé¢æµç¨‹

### 4.3 E2Eæµ‹è¯•
**èŒƒå›´**: å®Œæ•´ç”¨æˆ·æµç¨‹  
**ç‰¹ç‚¹**: çœŸå®æµè§ˆå™¨ã€ç«¯åˆ°ç«¯  
**å·¥å…·**: Playwright

**é‡ç‚¹æµ‹è¯•**:
- ç”¨æˆ·æ³¨å†Œç™»å½•
- åˆ›å»ºåŠ å…¥æˆ¿é—´
- æ¸¸æˆå®Œæ•´æµç¨‹
- é”™è¯¯åœºæ™¯å¤„ç†

---

## 5. ç¼–å†™è§„èŒƒ

### 5.1 æµ‹è¯•ç»“æ„ - AAAæ¨¡å¼
```typescript
test('should calculate correct pot distribution', () => {
  // Arrange - å‡†å¤‡æµ‹è¯•æ•°æ®
  const gameState = new GameState('room123', 10, 20);
  const players = [createPlayer('p1'), createPlayer('p2')];
  
  // Act - æ‰§è¡Œè¢«æµ‹è¯•çš„æ“ä½œ
  const result = gameState.distributePot(players);
  
  // Assert - éªŒè¯ç»“æœ
  expect(result).toHaveLength(2);
  expect(result[0].amount).toBe(100);
});
```

### 5.2 Mockä½¿ç”¨åŸåˆ™
- **é€‚åº¦Mock**: åªMockå¿…è¦çš„å¤–éƒ¨ä¾èµ–
- **æ¥è¿‘çœŸå®**: Mockè¡Œä¸ºåº”è¯¥æ¥è¿‘çœŸå®å®ç°
- **é›†ä¸­ç®¡ç†**: å¤ç”¨çš„Mockæ”¾åœ¨helpersä¸­

### 5.3 æ–­è¨€æ ‡å‡†
```typescript
// âœ… æ˜ç¡®çš„æ–­è¨€
expect(result).toBe(true)                 // ç²¾ç¡®å€¼
expect(result).toEqual(expectedObject)    // å¯¹è±¡æ¯”è¾ƒ
expect(array).toHaveLength(3)            // æ•°ç»„é•¿åº¦
expect(mockFn).toHaveBeenCalledWith(arg) // Mockè°ƒç”¨

// âœ… DOMæ–­è¨€
expect(element).toBeInTheDocument()
expect(element).toHaveClass('active')
expect(element).toHaveTextContent('Hello')
```

### 5.4 å¼‚æ­¥æµ‹è¯•
```typescript
// Promise
test('should handle async operation', async () => {
  await expect(asyncFunction()).resolves.toBe(result);
});

// å›è°ƒ
test('should handle callback', (done) => {
  callback((result) => {
    expect(result).toBeDefined();
    done();
  });
});
```

---

## 6. è´¨é‡æ ‡å‡†

### 6.1 è¦†ç›–ç‡è¦æ±‚
| æ¨¡å—ç±»å‹ | è¡Œè¦†ç›–ç‡ | å‡½æ•°è¦†ç›–ç‡ | åˆ†æ”¯è¦†ç›–ç‡ |
|---------|---------|----------|----------|
| **æ¸¸æˆé€»è¾‘** | â‰¥95% | â‰¥95% | â‰¥90% |
| **APIè·¯ç”±** | â‰¥90% | â‰¥90% | â‰¥85% |
| **UIç»„ä»¶** | â‰¥85% | â‰¥85% | â‰¥80% |
| **å·¥å…·å‡½æ•°** | â‰¥95% | â‰¥95% | â‰¥90% |

### 6.2 æ€§èƒ½è¦æ±‚
- **å•å…ƒæµ‹è¯•**: æ¯ä¸ªæµ‹è¯• < 5ç§’
- **é›†æˆæµ‹è¯•**: æ¯ä¸ªæµ‹è¯• < 30ç§’  
- **E2Eæµ‹è¯•**: æ¯ä¸ªæµ‹è¯• < 2åˆ†é’Ÿ
- **ç»„ä»¶æ¸²æŸ“**: åˆå§‹æ¸²æŸ“ < 100ms

### 6.3 ä»£ç è´¨é‡
- **å¯è¯»æ€§**: æ¸…æ™°çš„å˜é‡åå’Œæ³¨é‡Š
- **ç»´æŠ¤æ€§**: é¿å…é‡å¤ä»£ç ï¼Œä½¿ç”¨helpers
- **ç¨³å®šæ€§**: é¿å…éšæœºå¤±è´¥çš„æµ‹è¯•
- **ç›¸å…³æ€§**: æµ‹è¯•åº”è¯¥æµ‹è¯•æœ‰æ„ä¹‰çš„è¡Œä¸º

---

## 7. å·¥å…·å’Œé…ç½®

### 7.1 æµ‹è¯•å·¥å…·æ ˆ
| å±‚çº§ | å·¥å…· | é…ç½®æ–‡ä»¶ |
|-----|------|---------|
| **åç«¯** | Jest + ts-jest | `jest.config.js` |
| **å‰ç«¯** | Vitest + React Testing Library | `vitest.config.ts` |
| **E2E** | Playwright | `playwright.config.ts` |

### 7.2 å…³é”®é…ç½®
- **è¶…æ—¶è®¾ç½®**: åˆç†çš„è¶…æ—¶æ—¶é—´
- **å¹¶è¡Œæ‰§è¡Œ**: æé«˜æµ‹è¯•æ•ˆç‡
- **è¦†ç›–ç‡æŠ¥å‘Š**: HTML + LCOVæ ¼å¼
- **å¤±è´¥é‡è¯•**: CIç¯å¢ƒé‡è¯•æœºåˆ¶

### 7.3 æµ‹è¯•æ•°æ®ç®¡ç†
- **Fixtures**: æ ‡å‡†æµ‹è¯•æ•°æ®é›†
- **Factories**: åŠ¨æ€ç”Ÿæˆæµ‹è¯•æ•°æ®
- **Helpers**: å¸¸ç”¨æµ‹è¯•å·¥å…·å‡½æ•°
- **Setup/Teardown**: ç¯å¢ƒå‡†å¤‡å’Œæ¸…ç†

---

## 8. ç»´æŠ¤æŒ‡å—

### 8.1 å®šæœŸç»´æŠ¤ä»»åŠ¡
- **æ¯å‘¨**: æ£€æŸ¥æµ‹è¯•æ‰§è¡Œæ—¶é—´å’Œå¤±è´¥ç‡
- **æ¯æœˆ**: å®¡æŸ¥æµ‹è¯•è¦†ç›–ç‡å’Œè´¨é‡
- **æ¯å­£åº¦**: æ¸…ç†è¿‡æ—¶æµ‹è¯•å’Œé‡æ„

### 8.2 æŒç»­æ”¹è¿›
- **ç›‘æ§æŒ‡æ ‡**: æµ‹è¯•æ‰§è¡Œæ—¶é—´ã€é€šè¿‡ç‡ã€è¦†ç›–ç‡
- **åé¦ˆå¾ªç¯**: å›¢é˜Ÿå®šæœŸè®¨è®ºæµ‹è¯•å®è·µ
- **å·¥å…·å‡çº§**: ä¿æŒæµ‹è¯•å·¥å…·çš„æœ€æ–°ç‰ˆæœ¬

### 8.3 é—®é¢˜å¤„ç†
- **ä¸ç¨³å®šæµ‹è¯•**: ç«‹å³ä¿®å¤éšæœºå¤±è´¥çš„æµ‹è¯•
- **æ…¢é€Ÿæµ‹è¯•**: ä¼˜åŒ–æˆ–ç§»è‡³é€‚å½“åˆ†ç±»
- **è¿‡æ—¶æµ‹è¯•**: åŠæ—¶æ¸…ç†æ— æ•ˆæµ‹è¯•

---

## 9. å¿«é€Ÿå‚è€ƒ

### 9.1 å¸¸ç”¨å‘½ä»¤
```bash
# åç«¯æµ‹è¯•
npm test                          # è¿è¡Œæ‰€æœ‰æµ‹è¯•
npm run test:coverage            # è¦†ç›–ç‡æµ‹è¯•
npm test -- --watch             # ç›‘è§†æ¨¡å¼
npm test -- --testPathPattern=unit  # åªè¿è¡Œå•å…ƒæµ‹è¯•

# å‰ç«¯æµ‹è¯•
npm test                         # è¿è¡Œæ‰€æœ‰æµ‹è¯•  
npm run test:coverage           # è¦†ç›–ç‡æµ‹è¯•
npm test -- --watch            # ç›‘è§†æ¨¡å¼

# E2Eæµ‹è¯•
npm test                        # è¿è¡ŒE2Eæµ‹è¯•
npm test -- --headed           # æœ‰ç•Œé¢æ¨¡å¼

# å…¨éƒ¨æµ‹è¯•
./test-all.sh all              # è¿è¡Œæ‰€æœ‰æµ‹è¯•
```

### 9.2 ç¼–å†™æ£€æŸ¥æ¸…å•
- [ ] æµ‹è¯•æ–‡ä»¶ä½ç½®å’Œå‘½åæ­£ç¡®
- [ ] æµ‹è¯•æè¿°æ¸…æ™°å…·ä½“
- [ ] ä½¿ç”¨AAAæ¨¡å¼ç»„ç»‡ä»£ç 
- [ ] Mockä½¿ç”¨åˆç†
- [ ] æ–­è¨€å‡†ç¡®æ˜ç¡®
- [ ] è¦†ç›–è¾¹ç•Œæƒ…å†µå’Œé”™è¯¯å¤„ç†
- [ ] æµ‹è¯•æ‰§è¡Œå¿«é€Ÿç¨³å®š
- [ ] ä»£ç æ¸…æ™°æ˜“è¯»

### 9.3 å¸¸è§é—®é¢˜
**Q: ä»€ä¹ˆæ—¶å€™éœ€è¦Mock?**
A: å¤–éƒ¨ä¾èµ–(APIã€æ•°æ®åº“ã€æ–‡ä»¶ç³»ç»Ÿ)ã€éšæœºæ€§ã€æ—¶é—´ç›¸å…³é€»è¾‘

**Q: å¦‚ä½•æé«˜æµ‹è¯•æ‰§è¡Œé€Ÿåº¦?**
A: å‡å°‘ä¸å¿…è¦çš„å¼‚æ­¥æ“ä½œã€ä½¿ç”¨æµ…æ¸²æŸ“ã€å¹¶è¡Œæ‰§è¡Œã€åˆç†åˆ†ç»„

**Q: æµ‹è¯•è¦†ç›–ç‡è¾¾åˆ°100%æ˜¯å¿…è¦çš„å—?**
A: ä¸æ˜¯ï¼Œåº”è¯¥å…³æ³¨è´¨é‡è€Œéæ•°é‡ï¼Œé‡ç‚¹è¦†ç›–æ ¸å¿ƒé€»è¾‘å’Œè¾¹ç•Œæƒ…å†µ

### 9.4 èµ„æºé“¾æ¥
- [Jestå®˜æ–¹æ–‡æ¡£](https://jestjs.io/)
- [Vitestå®˜æ–¹æ–‡æ¡£](https://vitest.dev/)
- [React Testing Library](https://testing-library.com/docs/react-testing-library/intro/)
- [Playwrightå®˜æ–¹æ–‡æ¡£](https://playwright.dev/)

---

**æ–‡æ¡£ç‰ˆæœ¬**: v2.0  
**æœ€åæ›´æ–°**: 2025-06-17  
**ç»´æŠ¤è€…**: å¾·å·æ‰‘å…‹å¼€å‘å›¢é˜Ÿ

**å˜æ›´è®°å½•**:
- v2.0: ç®€åŒ–æ–‡æ¡£ç»“æ„ï¼Œå‡å°‘å†—ä½™ä»£ç ï¼Œå¢å¼ºå®ç”¨æ€§
- v1.0: åˆå§‹ç‰ˆæœ¬ï¼Œè¯¦ç»†ä»£ç ç¤ºä¾‹

---

## é™„å½•: ç¤ºä¾‹æ¨¡æ¿

### A.1 å•å…ƒæµ‹è¯•æ¨¡æ¿
```typescript
import { YourClass } from '../../../src/path/to/YourClass';

describe('YourClass', () => {
  describe('methodName', () => {
    test('should handle normal case', () => {
      // Arrange
      const instance = new YourClass();
      
      // Act
      const result = instance.methodName(input);
      
      // Assert
      expect(result).toEqual(expected);
    });
    
    test('should handle edge case', () => {
      // Test edge case
    });
    
    test('should throw error for invalid input', () => {
      // Test error case
    });
  });
});
```

### A.2 ç»„ä»¶æµ‹è¯•æ¨¡æ¿
```typescript
import { render, screen } from '@testing-library/react';
import YourComponent from '../../src/components/YourComponent';

describe('YourComponent', () => {
  test('renders with required props', () => {
    render(<YourComponent prop="value" />);
    
    expect(screen.getByText('Expected Text')).toBeInTheDocument();
  });
  
  test('handles user interaction', () => {
    const handleClick = vi.fn();
    render(<YourComponent onClick={handleClick} />);
    
    // Simulate interaction and test
  });
});
```